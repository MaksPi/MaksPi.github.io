<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial=scale=1.0">

	<title>Отладка в браузере Chrome</title>
	
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/fonts.css">
	<link rel="shortcut icon" href="../img/iconfinder_graduation_cap.png">
</head>

<body>
	<div class="page-wrapper">
		<div class="page">
			<div class="main__header">
				<div class="main__header-group">
					<ol class="breadcrumbs">
						<li class="breadcrumbs__item breadcrumbs__item_home">
							<a class="breadcrumbs__link" title="Оглавление" href="../index.html"></a>
						</li>
						<li class="breadcrumbs__item"></li>
					</ol>
					<div class="updated-at">
						<div class="updated-at__content">28-го июня 2020</div>
					</div>
				</div>
				<h1 class="page__title">Отладка в браузере Chrome</h1>
			</div>
			<p><a href="https://ru.wikipedia.org/wiki/%D0%9E%D1%82%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B">Отладка</a> – это процесс поиска и исправления ошибок в скрипте. Все современные браузеры и большинство других сред разработки поддерживают инструменты для отладки – специальный графический интерфейс, который сильно упрощает отладку. Он также позволяет по шагам отследить, что именно происходит в нашем коде.</p>
			<p>Здесь для обучения будет использоваться браузер Chrome, так как у него достаточно возможностей, в большинстве других браузеров процесс будет схожим.</p>
			<h2>Панель «Исходный код» («Sources»)</h2>
			<p>В зависимости от версии, Chrome может выглядеть немного иначе, однако принципиальных отличий не будет.</p>
			<ul>
				<li>Работая в Chrome - открыть <a href="debugging-chrome/debugging/index.html">тестовую страницу</a>.</li>
				<li>Включить инструменты разработчика, нажав <kbd class="shortcut">F12</kbd> (Mac: <kbd class="shortcut">Cmd<span class="shortcut__plus">+</span>Opt<span class="shortcut__plus">+</span>I</kbd>).</li>
				<li>Щёлкнуть по панели <code>sources</code> («исходный код»).</li>
			</ul>
			<p>При первом запуске получается следующее:</p>
			<div class="image" style="width: 697px">
				<iframe style="width: 697px; height: calc(228px + 4px)" src="../code-quality/debugging-chrome/debugging.html"></iframe>
				<div class="image__ratio" style="padding-top: 33.28550932568%"></div>
			</div>
			<p>Кнопка-переключатель <span class="devtools" style="background-position:-168px -76px"></span> откроет вкладку со списком файлов.</p>
			<p>Если кликнуть на неё и выберать <code>hello.js</code>, то вот что появится:</p>
			<div class="image" style="width: 694px">
				<iframe style="width: 694px; height: calc(225px + 4px)" src="../code-quality/debugging-chrome/chrome-tabs.html"></iframe>
				<div class="image__ratio" style="padding-top: 32.99711815562%"></div>
			</div>
			<p>Интерфейс состоит из трёх зон:</p>
			<ol>
				<li>В зоне <strong>Resources</strong> (Ресурсы) показаны файлы HTML, JavaScript, CSS, включая изображения, используемые на странице. Здесь также могут быть файлы различных расширений Chrome.</li>
				<li>Зона <strong>Source</strong> показывает исходный код.</li>
				<li>Наконец, зона <strong>Information and control</strong> (Сведения и контроль) отведена для отладки, вскоре мы к ней вернёмся.</li>
			</ol>
			<p>Чтобы скрыть список ресурсов и освободить экранное место для исходного кода, нужно щёлкнуть по тому же переключателю <span class="devtools" style="background-position:-200px -76px"></span>.</p>
			<h2>Консоль</h2>
			<p>При нажатии на клавишу <kbd class="shortcut">Esc</kbd> в нижней части экрана вызывается консоль, где можно вводить команды и выполнять их клавишей <kbd class="shortcut">Enter</kbd>.</p>
			<p>Результат выполнения инструкций сразу же отображается в консоли.</p>
			<p>Например, результатом <code>1+2</code> будет <code>3</code>, а инструкция <code>hello("debugger")</code> ничего не возвращает, так что получаем <code>undefined</code>:</p>
			<div class="image" style="width: 693px">
				<iframe style="width: 693px; height: calc(156px + 4px)" src="../code-quality/debugging-chrome/chrome-sources-console.html"></iframe>
				<div class="image__ratio" style="padding-top: 23.08802308802%"></div>
			</div>
			<h2>Точки останова (breakpoints)</h2>
			<p>Давайте разберёмся, как работает код нашей <a href="debugging-chrome/debugging/index.html">тестовой страницы</a>. В файле <code>hello.js</code> щёлкните по строчке номер <code>4</code>. Да, щёлкайте именно по самой цифре, не по коду.</p>
			<p>Ура! Вы поставили точку останова. А теперь щёлкните по цифре <code>8</code> на восьмой линии. Номер строки будет окрашен в синий цвет.</p>
			<p>Вот что в итоге должно получиться:</p>
			<div class="image" style="width: 697px">
				<iframe style="width: 697px; height: calc(244px + 4px)" src="../code-quality/debugging-chrome/chrome-sources-breakpoint.html"></iframe>
				<div class="image__ratio" style="padding-top: 35.58106169297%"></div>
			</div>
			<p><em>Точка останова</em> – это участок кода, где отладчик автоматически приостановит исполнение JavaScript.</p>
			<p>Пока исполнение поставлено «на паузу», мы можем просмотреть текущие значения переменных, выполнить команды в консоли, одним словом, мы выполняем отладку кода.</p>
			<p>В правой части графического интерфейса мы видим список точек останова. А когда таких точек выставлено много, да ещё и в разных файлах, этот список поможет эффективно ими управлять:</p>
			<ul>
				<li>Быстро переместиться к любой точке останова в коде – нужно щёлкнуть по точке в правой части экрана.</li>
				<li>Временно деактивировать точку – в общем списке снимите галочку напротив ненужной в данный момент точки.</li>
				<li>Удалить точку – щёлкните по ней правой кнопкой мыши и выберите Remove (Удалить).</li>
				<li>…и так далее.</li>
			</ul>
			<div class="important important_smart">
				<div class="important__header"><span class="important__type">Условные точки останова</span></div>
				<div class="important__content"><p>Можно задать и так называемую <em>условную</em> точку останова – щёлкните правой кнопкой мыши по номеру строки в коде. Если задать выражение, то именно при его истинности выполнение кода будет приостановлено.</p>
					<p>Этот метод используется, когда выполнение кода нужно остановить при присвоении определённого выражения какой-либо переменной или при определённых параметрах функции.</p>
				</div>
			</div>
			<h2>Команда Debugger</h2>
			<p>Выполнение кода можно также приостановить с помощью команды <code>debugger</code> прямо изнутри самого кода:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers language-javascript">
						<code class="language-javascript">
							<code class="token keyword">function</code> <code class="token function">hello</code><code class="token punctuation">(</code><code class="token parameter">name</code><code class="token punctuation">)</code> <code class="token punctuation">{</code><br>
							<code class="token keyword rows-double-indentation">let</code> phrase <code class="token operator">=</code> <code class="token template-string"><code class="token string">`Привет, </code><code class="token interpolation"><code class="token interpolation-punctuation punctuation">${</code>name<code class="token interpolation-punctuation punctuation">}</code></code><code class="token string">!`</code></code><code class="token punctuation">;</code><br><br>
							<code class="token keyword rows-double-indentation">debugger</code><code class="token punctuation">;</code>  <code class="token comment">// &lt;-- здесь выполнение прерывается</code><br><br>
							<code class="token function rows-double-indentation">say</code><code class="token punctuation">(</code>phrase<code class="token punctuation">)</code><code class="token punctuation">;</code><br>
							<code class="token punctuation">}</code>
						</code>
						<span class="line-numbers-rows">
							<script src="../js/line-numbers-rows.js"></script>
							<script>rowsNumbers(7);</script>
						</span>
					</div>
				</div>
			</div>
			<p>Способ удобен тем, что можно продолжить работать в редакторе кода без необходимости переключения в браузер для выставления точки останова.</p>
			<h2>Остановимся и оглядимся</h2>
			<p>В нашем примере функция <code>hello()</code> вызывается во время загрузки страницы, поэтому для начала отладки (после того, как мы поставили точки останова) проще всего её перезагрузить. Нажмите <kbd class="shortcut">F5</kbd> (Windows, Linux) или <kbd class="shortcut">Cmd<span class="shortcut__plus">+</span>R</kbd> (Mac).</p>
			<p>Выполнение прервётся на четвёртой строчке:</p>
			<div class="image" style="width: 700px">
				<iframe style="width: 700px; height: calc(304px + 4px)" src="../code-quality/debugging-chrome/chrome-sources-debugger-pause.html"></iframe>
				<div class="image__ratio" style="padding-top: 44%"></div>
			</div>
			<p>Чтобы понять, что происходит в коде, щёлкните по стрелочкам справа:</p>
			<ol>
				<li>
					<p><strong><code>Watch</code> показывает текущие значения выражений.</strong></p>
					<p>Нажмите на <code>+</code> и введите выражение. В процессе выполнения отладчик автоматически пересчитывает и выводит его значение.</p>
				</li>
				<li>
					<p><strong><code>Call Stack</code> показывает последовательность вызовов функций.</strong></p>
					<p>В нашем примере отладчик работает с функцией <code>hello()</code>, вызванной скриптом из файла <code>index.html</code> (там нет функции, поэтому вызов «анонимный»).</p>
					<p>При нажатии на элемент списка (например, на «anonymous») отладчик переходит к соответствующему коду, и нам представляется возможность его проанализировать.</p>
				</li>
				<li>
					<p><strong><code>Scope</code> показывает текущие переменные.</strong></p>
					<p>В <code>Local</code> отображаются локальные переменные функций, а их значения подсвечены в исходном коде.</p>
					<p>В <code>Global</code> перечисляются глобальные переменные (т.е. объявленные за пределами функций).</p>
					<p>Не обращайте пока внимание на ключевое слово <code>this</code> – его мы изучим чуть позже.</p>
				</li>
			</ol>
			<h2>Пошаговое выполнение скрипта</h2>
			<p>А теперь давайте <em>пошагаем</em> по нашему коду.</p>
			<p>В правой части панели для этого есть несколько кнопок. Рассмотрим их.</p>
			<dl>
				<dt><span class="devtools" style="background-position:-7px -76px"></span> – продолжить выполнение. Быстрая клавиша – <kbd class="shortcut">F8</kbd>.</dt>
				<dd>
					<p>Возобновляет выполнение кода. Если больше нет точек останова, отладчик прекращает работу и позволяет приложению работать дальше.</p>
					<p>Вот, что мы увидим, кликнув на неё:</p>
					<div class="image" style="width: 698px">
						<iframe style="width: 698px; height: calc(310px + 4px)" src="../code-quality/debugging-chrome/chrome-sources-debugger-trace-1.html"></iframe>
						<div class="image__ratio" style="padding-top: 44.98567335244%"></div>
					</div>
					<p>Выполнение кода возобновилось, дошло до другой точки останова внутри <code>say()</code>, и отладчик снова приостановил выполнение. Обратите внимание на пункт «Call stack» справа: в списке появился ещё один вызов. Мы теперь внутри функции <code>say()</code>.</p>
				</dd>
				<dt><span class="devtools" style="background-position:-137px -76px"></span> – сделать шаг (выполнить следующую команду), <em>не заходя в функцию</em>. Быстрая клавиша – <kbd class="shortcut">F10</kbd>.</dt>
				<dd>
					<p>Если мы нажмём на неё – будет вызван <code>alert</code>. Важно: на месте <code>alert</code> может быть любая другая функция, выполнение просто <em>перешагнёт через неё</em>, полностью игнорируя её содержимое.</p>
				</dd>
				<dt><span class="devtools" style="background-position:-72px -76px"></span> – сделать шаг. Быстрая клавиша – <kbd class="shortcut">F11</kbd>.</dt>
				<dd>
					<p>В отличие от предыдущего примера, здесь мы «заходим» во вложенные функции и шаг за шагом проходим по скрипту.</p>
				</dd>
				<dt><span class="devtools" style="background-position:-104px -76px"></span> – продолжить выполнение до завершения текущей функции. Быстрая клавиша – <kbd class="shortcut">Shift<span class="shortcut__plus">+</span>F11</kbd>.</dt>
				<dd>
					<p>Выполнение кода остановится на самой последней строчке текущей функции. Этот метод применяется, когда мы случайно нажали <span class="devtools" style="background-position:-72px -76px"></span> и зашли в функцию, но нам она неинтересна и мы как можно скорее хотим из неё выбраться.</p>
				</dd>
				<dt><span class="devtools" style="background-position:-7px -28px"></span> – активировать/деактивировать все точки останова.</dt>
				<dd>
					<p>Эта кнопка не влияет на выполнение кода, она лишь позволяет массово включить/отключить точки останова.</p>
				</dd>
				<dt><span class="devtools" style="background-position:-264px -4px"></span> – разрешить/запретить остановку выполнения в случае возникновения ошибки.</dt>
				<dd>
					<p>Если опция включена и инструменты разработчика открыты, любая ошибка в скрипте приостанавливает выполнение кода, что позволяет его проанализировать. Поэтому если скрипт завершается с ошибкой, открываем отладчик, включаем эту опцию, перезагружаем страницу и локализуем проблему.</p>
				</dd>
			</dl>
			<div class="important important_smart">
				<div class="important__header"><span class="important__type">Continue to here</span></div>
				<div class="important__content"><p>Если щёлкнуть правой кнопкой мыши по строчке кода, в контекстном меню можно выбрать опцию «Continue to here» («продолжить до этого места»).</p>
					<p>Этот метод используется, когда нам нужно продвинуться на несколько шагов вперёд до нужной строки, но лень выставлять точки останова.</p>
				</div>
			</div>
			<h2>Логирование</h2>
			<p>Если нужно что-то вывести в консоль из кода, применяется функция <code>console.log</code>.</p>
			<p>К примеру, выведем в консоль значения от нуля до четырёх:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers language-javascript">
						<code class="language-javascript">
							<code class="token comment">// чтобы увидеть результат, сначала откройте консоль</code><br>
							<code class="token keyword">for</code> <code class="token punctuation">(</code><code class="token keyword">let</code> i <code class="token operator">=</code> <code class="token number">0</code><code class="token punctuation">;</code> i <code class="token operator">&lt;</code> <code class="token number">5</code><code class="token punctuation">;</code> i<code class="token operator">++</code><code class="token punctuation">)</code> <code class="token punctuation">{</code><br>
							<code class="toket rows-double-indentation">console</code><code class="token punctuation">.</code><code class="token function">log</code><code class="token punctuation">(</code><code class="token string">"value,"</code><code class="token punctuation">,</code> i<code class="token punctuation">)</code><code class="token punctuation">;</code><br>
							<code class="token punctuation">}</code>
						</code>
						<span class="line-numbers-rows">
							<script src="../js/line-numbers-rows.js"></script>
							<script>rowsNumbers(4);</script>
						</span>
					</div>
				</div>
			</div>
			<p>Обычный пользователь сайта не увидит такой вывод, так как он в консоли. Напомним, что консоль можно открыть через инструменты разработчика – выберите вкладку «Консоль» или нажмите <kbd class="shortcut">Esc</kbd>, находясь в другой вкладке – консоль откроется в нижней части интерфейса.</p>
			<p>Если правильно выстроить логирование в приложении, то можно и без отладчика разобраться, что происходит в коде.</p>
		</div>
	</div>
</body>

</html>