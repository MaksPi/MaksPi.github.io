<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>DOM-дерево</title>
	
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/fonts.css">
</head>
<body>
	<div class="page-wrapper">
		<div class="page">
			<h1 class="page__title">DOM-дерево</h1>
			<p>Основой HTML-документа являются теги.</p>
			<p>В соответствии с объектной моделью документа («Document Object Model», коротко DOM), каждый HTML-тег является объектом. Вложенные теги являются «детьми» родительского элемента. Текст, который находится внутри тега, также является объектом.</p>
			<p>Все эти объекты доступны при помощи JavaScript, которые можно использовать для изменения страницы.</p>
			<p>Например, <code>document.body</code> – объект для тега <code>&lt;body&gt;</code>.</p>
			<p>Если запустить этот код, то <code>&lt;body&gt;</code> станет красным на 3 секунды:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							document<code class="token punctuation">.</code>body<code class="token punctuation">.</code>style<code class="token punctuation">.</code>background
							<code class="token operator">=</code>
							<code class="token string">'red'</code><code class="token punctuation">;</code>
							<code class="token comment">// сделать фон красным</code><br><br>
							<code class="token function">setTimeout</code><code class="token punctuation">(</code><code class="token punctuation">(</code><code class="token punctuation">)</code>
							<code class="token operator">=&gt;</code>
							document<code class="token punctuation">.</code>body<code class="token punctuation">.</code>style<code class="token punctuation">.</code>background
							<code class="token operator">=</code>
							<code class="token string">''</code><code class="token punctuation">,</code>
							<code class="token number">3000</code><code class="token punctuation">)</code><code class="token punctuation">;</code>
							<code class="token comment">// вернуть назад</code>
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span><br>
							<span>3</span>
						</span>
					</div>
				</div>
			</div>
			<p>Это был лишь небольшой пример того, что может DOM.</p>
			<h2>Пример DOM</h2>
			<p>Пример простого документа:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							<code class="token doctype">&lt;!DOCTYPE HTML&gt;</code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>html</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>head</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag rows-double-indentation"><code class="token tag"><code class="token punctuation">&lt;</code>title</code><code class="token punctuation">&gt;</code></code>О лосях<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>title</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>head</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<span class="rows-double-indentation">Правда о лосях.</span><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>html</code><code class="token punctuation">&gt;</code></code><br>
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span><br>
							<span>3</span><br>
							<span>4</span><br>
							<span>5</span><br>
							<span>6</span><br>
							<span>7</span><br>
							<span>8</span><br>
							<span>9</span>
						</span>
					</div>
				</div>
			</div>
			<p>DOM – это представление HTML-документа в виде дерева тегов. Вот как оно выглядит:</p>
			<p>Теги являются <em>узлами-элементами</em> (или просто элементами). Они образуют структуру дерева: <code>&lt;html&gt;</code> – это корневой узел, <code>&lt;head&gt;</code> и <code>&lt;body&gt;</code> его дочерние узлы и т.д.</p>
			<p>Текст внутри элементов образует <em>текстовые узлы</em>. Текстовый узел содержит в себе только строку текста. У него не может быть потомков, т.е. он находится всегда на самом нижнем уровне.</p>
			<p>Например, в теге <code>&lt;title&gt;</code> есть текстовый узел <code>"О лосях"</code>.</p>
			<p>Пробелы и переводы строки – это полноправные символы, как буквы и цифры. Они образуют текстовые узлы и становятся частью дерева DOM. Так, в примере выше в теге <code>&lt;head&gt;</code> есть несколько пробелов перед <code>&lt;title&gt;</code>, которые образуют текстовый узел (он содержит в себе только перенос строки и несколько пробелов).</p>
			<p>Существует всего два исключения из этого правила:</p>
			<ol>
				<li>По историческим причинам пробелы и перевод строки перед тегом <code>&lt;head&gt;</code> игнорируются</li>
				<li>Если мы записываем что-либо после закрывающего тега <code>&lt;/body&gt;</code>, браузер автоматически перемещает эту запись в конец <code>body</code>, поскольку спецификация HTML требует, чтобы всё содержимое было внутри <code>&lt;body&gt;</code>. Поэтому после закрывающего тега <code>&lt;/body&gt;</code> не может быть никаких пробелов.</li>
			</ol>
			<p>В остальных случаях всё просто – если в документе есть пробелы (или любые другие символы), они становятся текстовыми узлами дерева DOM, и если мы их удалим, то в DOM их тоже не будет.</p>
			<p>Здесь пробельных текстовых узлов нет:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							<code class="token doctype">&lt;!DOCTYPE HTML&gt;</code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>html</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>head</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>title</code><code class="token punctuation">&gt;</code></code>О лосях<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>title</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>head</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>body</code><code class="token punctuation">&gt;</code></code>Правда о лосях.<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>body</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>html</code><code class="token punctuation">&gt;</code></code>
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span>
						</span>
					</div>
				</div>
			</div>
			<div class="important important_smart">
				<div class="important__header"><span class="important__type">Пробелы по краям строк и пробельные текстовые узлы скрыты в инструментах разработки</span></div>
				<div class="important__content"><p>При работе с деревом DOM, используя инструменты разработчика в браузере, пробелы в начале/конце текста и пустые текстовые узлы (переносы строк) между тегами обычно не отображаются.</p>
					<p>Таким образом инструменты разработки экономят место на экране.</p>
					<p>В дальнейших иллюстрациях DOM для краткости также будут пропускаться пробельные текстовые узлы там, где они не имеют значения. Обычно они не влияют на то, как отображается документ.</p>
				</div>
			</div>
			<h2>Автоисправление</h2>
			<p>Если браузер сталкивается с некорректно написанным HTML-кодом, он автоматически корректирует его при построении DOM.</p>
			<p>Например, в начале документа всегда должен быть тег <code>&lt;html&gt;</code>. Даже если его нет в документе – он будет в дереве DOM, браузер его создаст. То же самое касается и тега <code>&lt;body&gt;</code>.</p>
			<p>Например, если HTML-файл состоит из единственного слова <code>"Привет"</code>, браузер обернёт его в теги <code>&lt;html&gt;</code> и <code>&lt;body&gt;</code>, добавит необходимый тег <code>&lt;head&gt;</code>, и DOM будет выглядеть так:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>html</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>head</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>head</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<span class="rows-double-indentation">Привет</span><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>html</code><code class="token punctuation">&gt;</code></code><br>
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span><br>
							<span>3</span><br>
							<span>4</span><br>
							<span>5</span><br>
							<span>6</span><br>
							<span>7</span>
						</span>
					</div>
				</div>
			</div>
			<p>При генерации DOM браузер самостоятельно обрабатывает ошибки в документе, закрывает теги и так далее.</p>
			<p>Ещё пример: есть такой документ с незакрытыми тегами:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>p</code><code class="token punctuation">&gt;</code></code>Привет<br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>li</code><code class="token punctuation">&gt;</code></code>Мама<br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>li</code><code class="token punctuation">&gt;</code></code>и<br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>li</code><code class="token punctuation">&gt;</code></code>Папа
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span><br>
							<span>3</span><br>
							<span>4</span>
						</span>
					</div>
				</div>
			</div>
			<p>…Но DOM будет нормальным, потому что браузер сам закроет теги и восстановит отсутствующие детали:</p>
			<div class="important important_warn">
				<div class="important__header"><span class="important__type">Таблицы всегда содержат <code>&lt;tbody&gt;</code></span></div>
				<div class="important__content"><p>Важный «особый случай» – работа с таблицами. По стандарту DOM у них должен быть <code>&lt;tbody&gt;</code>, но в HTML их можно написать (официально) без него. В этом случае браузер добавляет <code>&lt;tbody&gt;</code> в DOM самостоятельно.</p>
					<p>Для такого HTML:</p>
					<div class="code-example">
						<div class="codebox">
							<div class="line-numbers  language-javascript">
								<code class=" language-javascript">
									<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>table</code> <code class="token attr-name">id</code><code class="token attr-value"><code class="token punctuation">=</code><code class="token punctuation">"</code>table<code class="token punctuation">"</code></code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>tr</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>td</code><code class="token punctuation">&gt;</code></code>1<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>td</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>tr</code><code class="token punctuation">&gt;</code></code><code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>table</code><code class="token punctuation">&gt;</code></code>
								</code>
								<span class="line-numbers-rows">
									<span>1</span>
								</span>
							</div>
						</div>
					</div>
					<p>DOM-структура будет такой:</p>
					<div class="code-example">
						<div class="codebox">
							<div class="line-numbers  language-javascript">
								<code class=" language-javascript">
									<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>table</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag"><code class="token punctuation">&lt;</code>tbody</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation">&lt;</code>tr</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation rows-double-indentation">&lt;</code>td</code><code class="token punctuation">&gt;</code></code><br>
									<code class="rows-double-indentation"><code class="rows-double-indentation"><code class="rows-double-indentation">1</code></code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation rows-double-indentation">&lt;/</code>td</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation">&lt;/</code>tr</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag rows-double-indentation"><code class="token tag"><code class="token punctuation">&lt;/</code>tbody</code><code class="token punctuation">&gt;</code></code><br>
									<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>table</code><code class="token punctuation">&gt;</code></code>
								</code>
								<span class="line-numbers-rows">
									<span>1</span><br>
									<span>2</span><br>
									<span>3</span><br>
									<span>4</span><br>
									<span>5</span><br>
									<span>6</span><br>
									<span>7</span><br>
									<span>8</span><br>
									<span>9</span>
								</span>
							</div>
						</div>
					</div>
					<p>Из пустоты появился <code>&lt;tbody&gt;</code>, как будто документ и был таким. Важно знать об этом, иначе при работе с таблицами возможны сюрпризы.</p>
				</div>
			</div>
			<h2>Другие типы узлов</h2>
			<p>Есть и некоторые другие типы узлов, кроме элементов и текстовых узлов.</p>
			<p>Например, узел-комментарий:</p>
			<div class="code-example">
				<div class="codebox">
					<div class="line-numbers  language-javascript">
						<code class=" language-javascript">
							<code class="token doctype">&lt;!DOCTYPE HTML&gt;</code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>html</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<code class="rows-double-indentation">Правда о лосях</code><br>
							<code class="token tag rows-double-indentation"><code class="token tag"><code class="token punctuation">&lt;</code>ol</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation">&lt;</code>li</code><code class="token punctuation">&gt;</code></code>Лось -- животное хитрое<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>li</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token comment rows-double-indentation"><code class="rows-double-indentation">&lt;!-- комментарий --&gt;</code></code><br>
							<code class="token tag rows-double-indentation"><code class="token tag rows-double-indentation"><code class="token punctuation">&lt;</code>li</code><code class="token punctuation">&gt;</code></code>...и коварное!<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>li</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag rows-double-indentation"><code class="token tag"><code class="token punctuation">&lt;/</code>ol</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>body</code><code class="token punctuation">&gt;</code></code><br>
							<code class="token tag"><code class="token tag"><code class="token punctuation">&lt;/</code>html</code><code class="token punctuation">&gt;</code></code>
						</code>
						<span class="line-numbers-rows">
							<span>1</span><br>
							<span>2</span><br>
							<span>3</span><br>
							<span>4</span><br>
							<span>5</span><br>
							<span>6</span><br>
							<span>7</span><br>
							<span>8</span><br>
							<span>9</span><br>
							<span>10</span><br>
							<span>11</span>
						</span>
					</div>
				</div>
			</div>
			<p>В примере выше в DOM дереве присутствует узел нового типа - <em>комментарий</em>.</p>
			<p><strong>Все, что есть в HTML, даже комментарии, является частью DOM.</strong></p>
			<p>Даже директива <code>&lt;!DOCTYPE...&gt;</code>, которая стоит в начале HTML, тоже является DOM-узлом. Она находится в дереве DOM прямо перед <code>&lt;html&gt;</code>.</p>
			<p>Даже объект <code>document</code>, представляющий весь документ, формально является DOM-узлом.</p>
			<p>Существует <a href="https://dom.spec.whatwg.org/#node">12 типов узлов</a>. Но на практике в основном работают с 4 из них:</p>
			<ol>
				<li><code>document</code> – «входная точка» в DOM.</li>
				<li>узлы-элементы – HTML-теги, основные строительные блоки.</li>
				<li>текстовые узлы – содержат текст.</li>
				<li>комментарии – иногда в них можно включить информацию, которая не будет показана, но доступна в DOM для чтения JS.</li>
			</ol>
			<p>Подробную документацию по инструментам разработки Chrome Developer Tools можно найти на странице <a href="https://developers.google.com/web/tools/chrome-devtools">https://developers.google.com/web/tools/chrome-devtools</a>.</p>
		</div>
	</div>
</body>
</html>